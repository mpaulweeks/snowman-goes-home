(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e,t,n){e.exports=n(44)},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var i,r=n(0),a=n.n(r),o=n(16),l=n.n(o),s=n(9),c=n(1),u=n(2),h=n(7),d=n(6),f=n(8),v=n(3),m=n(4),p=n(5),g=n(13);!function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Right=4]="Right"}(i||(i={}));var b,w=[i.Up,i.Down,i.Left,i.Right],y=function(){function e(t,n,i){Object(c.a)(this,e),this.point=void 0,this.points=void 0,this.moves=void 0,this.point=t,this.points=n,this.moves=i}return Object(u.a)(e,[{key:"addMove",value:function(e,t){this.points.push(this.point),this.moves.push(t),this.point=e}},{key:"getNextMoves",value:function(){var e=this;return w.map(function(t){return{move:t,history:e.clone()}})}},{key:"clone",value:function(){return new e(this.point,Object(g.a)(this.points),Object(g.a)(this.moves))}},{key:"printMoves",value:function(){return this.moves.map(function(e){return i[e]}).join(", ")}}]),e}();!function(e){e[e.Start=1]="Start",e[e.Win=2]="Win",e[e.Block=3]="Block"}(b||(b={}));var O=function(){function e(t,n,i,r,a){Object(c.a)(this,e),this.width=void 0,this.height=void 0,this.start=void 0,this.win=void 0,this.blocks=void 0,this.blocksByKey={},this.width=t,this.height=n,this.start=i,this.win=r,this.blocks=a,this.blocksByKey=this.blocks.reduce(function(e,t){return e[t.toString()]=b.Block,e},{})}return Object(u.a)(e,[{key:"isWinningPoint",value:function(e){return this.win.equals(e)}},{key:"isIllegalPoint",value:function(e){var t=this.blocksByKey,n=this.width,i=this.height;return!!t[e.toString()]||e.x<0||e.x>=n||e.y<0||e.y>=i}},{key:"applyMove",value:function(e,t){for(var n=e,r=[{move:t,point:n}];;){var a=n.clone();if(t===i.Left)a.x--;else if(t===i.Right)a.x++;else if(t===i.Up)a.y--;else{if(t!==i.Down)throw new Error("unexpected move: ".concat(t));a.y++}if(this.isIllegalPoint(a))break;if(r.push({move:t,point:a}),n=a,this.isWinningPoint(n))break}return{point:n,traveled:r}}},{key:"solve",value:function(){for(var e=this,t={},n=[new y(this.start,[],[])];n.length;){var i=n.shift(),r=i.point.toString();if(!t[r]){if(t[r]=!0,this.isWinningPoint(i.point))return i;i.getNextMoves().forEach(function(t){var i=t.move,r=t.history,a=e.applyMove(r.point,i).point;r.addMove(a,i),n.push(r)})}}return null}},{key:"print",value:function(){for(var e=this.width,t=this.height,n=this.start,i=this.win,r=this.blocks,a=[],o=function(t){for(var o=[],l=function(e){var a="_";i.x===e&&i.y===t&&(a="W"),n.x===e&&n.y===t&&(a="S"),r.forEach(function(n){n.x===e&&n.y===t&&(a="0")}),o.push(a)},s=0;s<e;s++)l(s);a.push(o)},l=0;l<t;l++)o(l);return a.map(function(e){return e.join("")}).join("\n")}}]),e}(),E=function e(t,n){Object(c.a)(this,e),this.level=void 0,this.soln=void 0,this.level=t,this.soln=n},k=function(){function e(t){Object(c.a)(this,e),this.level=void 0,this.soln=void 0,this.hero=void 0,this.level=t.level,this.soln=t.soln,this.hero=new y(this.level.start,[],[])}return Object(u.a)(e,[{key:"reset",value:function(){this.hero=new y(this.level.start,[],[])}},{key:"moveHero",value:function(e){var t=this.level,n=this.hero,i=t.applyMove(n.point,e);return n.addMove(i.point,e),i}}]),e}(),j=function(){function e(t,n){Object(c.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(u.a)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"toString",value:function(){return"".concat(this.x,",").concat(this.y)}},{key:"equals",value:function(e){return this.toString()===e.toString()}}],[{key:"fromString",value:function(t){var n=t.split(",");return new e(parseFloat(n[0]),parseFloat(n[1]))}}]),e}();function x(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}function L(e,t){return e+Math.random()*(t-e)}var M,T,_=function(){function e(t,n){Object(c.a)(this,e),this.spaces=[];for(var i=0;i<n;i++)for(var r=0;r<t;r++)this.spaces.push(new j(r,i))}return Object(u.a)(e,[{key:"pop",value:function(){var e=Math.floor(Math.random()*this.spaces.length);return this.spaces.splice(e,1)[0]}}]),e}(),P=function(){function e(t){Object(c.a)(this,e),this.settings=void 0,this.settings=t}return Object(u.a)(e,[{key:"tryGenerateLevel",value:function(e){var t=this.settings,n=t.width,i=t.height,r=t.minMovesOptions,a=new _(n,i),o=a.pop(),l=a.pop(),s=x(e).map(function(e){return a.pop()}),c=new O(n,i,l,o,s),u=c.solve();return u&&r.includes(u.moves.length)?new E(c,u):null}},{key:"generateLevels",value:function(e,t){for(var n=this.settings,i=n.width,r=n.height,a=n.blockPercentMin,o=n.blockPercentMax,l=[],s=0,c=Math.min(t/10,100);l.length<e&&s<t;)for(var u=i*r*L(a,o),h=0;l.length<e&&h<c;h++){s+=1;var d=this.tryGenerateLevel(u);d&&l.push(d)}return l}}]),e}(),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(c.a)(this,e),this.started=void 0,this.milliseconds=void 0,this.started=new Date,this.milliseconds=t}return Object(u.a)(e,[{key:"getElapsed",value:function(){return(new Date).getTime()-this.started.getTime()}},{key:"getRemaining",value:function(){return this.milliseconds-this.getElapsed()}},{key:"getPercent",value:function(){return this.getRemaining()/this.milliseconds}},{key:"addTime",value:function(e){this.milliseconds+=e}},{key:"formatElapsed",value:function(){return Math.floor(this.getElapsed()/1e3).toString(10)}},{key:"formatRemaining",value:function(){return Math.floor(this.getRemaining()/1e3).toString(10)}}]),e}(),D=n(11),R=n.n(D),A=n(15);!function(e){e[e.Easy=1]="Easy",e[e.Medium=2]="Medium",e[e.Hard=3]="Hard",e[e.Infinite=4]="Infinite"}(T||(T={}));var I,G=(M={},Object(p.a)(M,T.Easy,{boilFps:3,gridSize:1,levelsPerTier:1,minMoves:5,totalLevels:5}),Object(p.a)(M,T.Medium,{boilFps:3,gridSize:1.5,levelsPerTier:1,minMoves:10,totalLevels:10}),Object(p.a)(M,T.Hard,{boilFps:6,gridSize:2,levelsPerTier:2,minMoves:12,totalLevels:16}),Object(p.a)(M,T.Infinite,{boilFps:9,gridSize:1.5,levelsPerTier:3,minMoves:7,secondsPerLevel:10,totalLevels:20}),M),C=function(){function e(t,n){var i=this;Object(c.a)(this,e),this.dimensions=void 0,this.difficulty=void 0,this.totalLevels=void 0,this.progression=void 0,this.loaded=!1,this.onLoad=void 0,this.registerLoaded=function(){},this.dimensions=t,this.difficulty=n,this.progression=G[n],this.onLoad=new Promise(function(e,t){i.registerLoaded=function(){return e(i)}}),this.totalLevels=this.progression.totalLevels}return Object(u.a)(e,[{key:"displayName",value:function(){return T[this.difficulty]}},{key:"isInfinite",value:function(){return this.difficulty===T.Infinite}},{key:"createStopwatch",value:function(){var e=1e3*(60-(this.progression.secondsPerLevel||0));return new S(this.isInfinite()?e:void 0)}},{key:"generateLevels",value:function(){throw new Error("base class")}},{key:"loadLevel",value:function(e){throw new Error("base class")}}]),e}(),B=function(e){function t(e,n){var i;return Object(c.a)(this,t),(i=Object(h.a)(this,Object(d.a)(t).call(this,e,n))).levelsByMoves=void 0,i.levelsByMoves=x(i.progression.totalLevels/i.progression.levelsPerTier).reduce(function(e,t){return e[t+i.progression.minMoves]=[],e},{}),i}return Object(f.a)(t,e),Object(u.a)(t,[{key:"getLevelKeys",value:function(){return Object.keys(this.levelsByMoves).map(parseFloat).sort(function(e,t){return e<t?-1:e>t?1:0})}},{key:"generateLevels",value:function(){var e=this.dimensions,t=this.levelsByMoves,n=this.progression,i=n.gridSize,r=n.levelsPerTier,a=this.getLevelKeys().filter(function(e){return t[e].length<r});if(0===a.length)return this.loaded=!0,void this.registerLoaded();var o=new j(e.x*i,e.y*i);new P({width:o.x,height:o.y,blockPercentMin:.05,blockPercentMax:.3,minMovesOptions:a}).generateLevels(500,500).forEach(function(e){var n=t[e.soln.moves.length];n&&n.length<r&&n.push(e)})}},{key:"loadLevel",value:function(){var e=Object(A.a)(R.a.mark(function e(t){var n,i=this;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(;!this.loaded;)this.generateLevels();return n=this.getLevelKeys().reduce(function(e,t){return e.push.apply(e,Object(g.a)(i.levelsByMoves[t])),e},[]),e.abrupt("return",n[t]);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(C),W=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e,T.Infinite))).levels=[],n.lastIndex=0,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"generateLevels",value:function(){var e,t=this.dimensions,n=this.levels,i=this.progression,r=this.lastIndex,a=i.gridSize;if(n.length>r+10)return this.loaded=!0,void this.registerLoaded();var o,l,s=new j(t.x*a,t.y*a),c=new P({width:s.x,height:s.y,blockPercentMin:.05,blockPercentMax:.3,minMovesOptions:(o=i.minMoves,l=10,x(l).map(function(e){return e+o}))});(e=this.levels).push.apply(e,Object(g.a)(c.generateLevels(10,10))),n.length>r+10&&console.log("infinite loaded!")}},{key:"loadLevel",value:function(){var e=Object(A.a)(R.a.mark(function e(t){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(;t>this.levels.length;)this.generateLevels();return this.lastIndex=t,e.abrupt("return",this.levels[t]);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(C),H=function(){function e(t){Object(c.a)(this,e),this.loaders=void 0,this.loaders=[new W(t)].concat(Object(g.a)([T.Easy,T.Medium,T.Hard].map(function(e){return new B(t,e)})))}return Object(u.a)(e,[{key:"getLoaderByDifficulty",value:function(e){return this.loaders.filter(function(t){return t.difficulty===e})[0]}},{key:"loadInBackground",value:function(){var e=this.loaders.filter(function(e){return!e.loaded})[0];e&&(e.generateLevels(),e.loaded&&console.log("loaded:",T[e.difficulty]))}}]),e}(),U=n(10),z=function e(t){Object(c.a)(this,e),this.url=void 0,this.image=void 0,this.loaded=void 0;var n="sprite/".concat(t,".png"),i=new Image,r=new Promise(function(e,t){i.onload=function(){return e(!0)}});i.src=n,this.url=n,this.image=i,this.loaded=r},F=function(){function e(t){Object(c.a)(this,e),this.frames=void 0,this.loaded=void 0,this.default=void 0,this.frames=t.map(function(e){return new z(e)}),this.loaded=Promise.all(this.frames.map(function(e){return e.loaded})).then(function(e){return e.every(function(e){return e})}),this.default=this.atFrame(0)}return Object(u.a)(e,[{key:"atFrame",value:function(e){var t=this.frames;return t[Math.floor(e)%t.length]}}]),e}(),N={heroLeft:new F(["snowman_left"]),heroRight:new F(["snowman_right"]),groundIceBlue:new F(["ground_ice_blue"]),groundIceGray:new F(["ground_ice_gray"]),groundIceNavy:new F(["ground_ice_navy"]),groundIceWhite:new F(["ground_ice_white"]),treeLight:new F(["tree_light","tree_light_left","tree_light","tree_light_right"]),treeHeavy:new F(["tree_heavy","tree_heavy_right","tree_heavy","tree_heavy_left"]),igloo:new F(["igloo"])},q=Object(U.a)({},N,{loaded:Promise.all(Object.values(N).map(function(e){return e.loaded})).then(function(){return!0})}),K="gif/snow_diagonal.gif",Y="gif/snow_loose.gif",V="white",J="music/visager_shrine.mp3",X=(I={},Object(p.a)(I,T.Easy,{gridColor:"black",ground:q.groundIceWhite,music:"music/visager_village_dreaming.mp3",overlay:Y}),Object(p.a)(I,T.Medium,{gridColor:"black",ground:q.groundIceBlue,music:"music/visager_the_final_road.mp3",overlay:Y}),Object(p.a)(I,T.Hard,{gridColor:"white",ground:q.groundIceGray,music:"music/visager_the_great_forest.mp3",overlay:K}),Object(p.a)(I,T.Infinite,{gridColor:"white",ground:q.groundIceNavy,music:"music/visager_dark_sanctum.mp3",overlay:K}),I);function Q(){var e=Object(v.a)(["\n  display: none;\n"]);return Q=function(){return e},e}var Z=m.a.div(Q()),$=function(e){function t(){var e,n;Object(c.a)(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).elmMenu=void 0,n.elmsByDiff={},n.desiredVolume=.5,n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.elmMenu,n=this.elmsByDiff;if(this.props.store.audioPlaying){var i=e.store.world,r=this.props.store.world;i!==r&&this.stopAll();var a=r?n[r.difficulty]:t;a&&this.playElm(a)}else this.elmsByDiff={}}},{key:"render",value:function(){var e=this;return this.props.store.audioPlaying&&a.a.createElement(Z,null,a.a.createElement("audio",{loop:!0,src:J,ref:function(t){return t&&(e.elmMenu=t)}}),Object.keys(X).map(function(t){return a.a.createElement("audio",{key:t,loop:!0,src:X[t].music,ref:function(n){return n&&(e.elmsByDiff[t]=n)}})}))}},{key:"playElm",value:function(e){var t=this.desiredVolume;e.volume!==t&&(e.volume=t),e.play()}},{key:"stopElm",value:function(e){e.pause(),e.currentTime=0}},{key:"stopAll",value:function(){var e=this,t=this.elmMenu,n=this.elmsByDiff;t&&this.stopElm(t),Object.keys(n).forEach(function(t){return e.stopElm(n[t])})}}]),t}(a.a.Component),ee=Object(s.b)(function(e){return{store:e}})($),te=n(18),ne=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},ie={audioPlaying:!1,isGameOver:!1,isMobile:ne(),level:0,secondsElapsed:"",secondsRemaining:"",shouldDrawGrid:!1,shouldDrawTouch:ne(),showAbout:!1,showHow2Play:!0,showOptions:!1,showTutorial:!0,world:void 0},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GAME_OVER":return Object(U.a)({},e,{isGameOver:!0});case"SET_LEVEL":var n=t.payload.level;return Object(U.a)({},e,{level:n||0});case"SET_TIMER":var i=t.payload.stopwatch;return Object(U.a)({},e,{secondsElapsed:i?i.formatElapsed():"",secondsRemaining:i?i.formatRemaining():""});case"SET_WORLD":var r=t.payload.world;return Object(U.a)({},e,{isGameOver:!1,world:r});case"TOGGLE_ABOUT":return Object(U.a)({},e,{showAbout:!e.showAbout});case"TOGGLE_DRAW_GRID":return Object(U.a)({},e,{shouldDrawGrid:!e.shouldDrawGrid});case"TOGGLE_DRAW_TOUCH":return Object(U.a)({},e,{shouldDrawTouch:!e.shouldDrawTouch});case"TOGGLE_HOW2PLAY":return Object(U.a)({},e,{showHow2Play:!e.showHow2Play,showTutorial:!1});case"TOGGLE_MUSIC":return Object(U.a)({},e,{audioPlaying:!e.audioPlaying});case"TOGGLE_OPTIONS":return Object(U.a)({},e,{showOptions:!e.showOptions});default:return e}},ae=function(e){return{type:"SET_TIMER",payload:{stopwatch:e}}},oe=function(e){return{type:"SET_WORLD",payload:{world:e}}},le=function(){return{type:"TOGGLE_ABOUT",payload:{}}},se=function(){return{type:"TOGGLE_HOW2PLAY",payload:{}}},ce=function(){return{type:"TOGGLE_MUSIC",payload:{}}},ue=function(){return{type:"TOGGLE_OPTIONS",payload:{}}},he=Object(te.b)(re);function de(){var e=Object(v.a)(["\n  cursor: pointer;\n  text-transform: uppercase;\n\n  border-color: var(--foreground);\n  font-style: normal;\n  color: var(--foreground);\n\n  ","\n"]);return de=function(){return e},e}function fe(){var e=Object(v.a)(["\n  min-width: 4em;\n  padding: 0.25em 0.75em;\n  margin: 0 0.3em;\n  border-radius: 1em;\n\n  border: 2px solid grey;\n  font-style: italic;\n  color: grey;\n  background-color: var(--background);\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  flex-wrap: nowrap;\n"]);return fe=function(){return e},e}function ve(){var e=Object(v.a)(["\n  padding: 0.5em;\n  margin: 0.5em;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n\n  background-color: var(--background);\n  border-radius: 1em;\n  border: 1px solid var(--snow);\n  box-sizing: border-box;\n"]);return ve=function(){return e},e}function me(){var e=Object(v.a)(["\n  justify-content: center;\n  background-image: url('","');\n  background-repeat: repeat;\n"]);return me=function(){return e},e}function pe(){var e=Object(v.a)(["\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  z-index: 1;\n  width: 100%;\n  height: 100vh;\n\n  background-color: var(--background);\n"]);return pe=function(){return e},e}function ge(){var e=Object(v.a)(["\n  text-align: center;\n  margin: 0em 0.5em;\n  font-family: monospace;\n  font-style: italic;\n\n  & img {\n    margin-left: 0.5em;\n    margin-right: 0.5em;\n  }\n\n  & "," {\n    justify-content: center;\n    align-items: center;\n  }\n"]);return ge=function(){return e},e}function be(){var e=Object(v.a)(["\n  margin: 1em 0.5em;\n"]);return be=function(){return e},e}function we(){var e=Object(v.a)(["\n  flex-direction: column;\n"]);return we=function(){return e},e}function ye(){var e=Object(v.a)(["\n  margin-top: 0em;\n  &:first-child {\n    margin-top: 1em;\n  }\n"]);return ye=function(){return e},e}function Oe(){var e=Object(v.a)(["\n  margin: 1em 0.5em;\n"]);return Oe=function(){return e},e}function Ee(){var e=Object(v.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n  align-items: stretch;\n  flex-wrap: nowrap;\n"]);return Ee=function(){return e},e}var ke=m.a.div(Ee()),je=Object(m.a)(ke)(Oe()),xe=Object(m.a)(je)(ye()),Le=Object(m.a)(ke)(we()),Me=Object(m.a)(Le)(be()),Te=m.a.h1(ge(),ke),_e=Object(m.a)(Le)(pe()),Pe=Object(m.a)(_e)(me(),q.groundIceWhite.default.url),Se=m.a.div(ve()),De=m.a.div(fe()),Re=Object(m.a)(De)(de(),!ne()&&"\n    &:hover {\n      color: var(--background);\n      background-color: var(--foreground);\n    }\n  "),Ae=function(){return a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(Te,null,a.a.createElement(ke,null,"Snowman",a.a.createElement("img",{alt:"",src:q.heroLeft.default.url})),a.a.createElement(ke,null,a.a.createElement("img",{alt:"",src:q.igloo.default.url}),"Goes Home"))))};function Ie(){var e=Object(v.a)(["\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  background-image: url('","');\n  background-size: contain;\n  background-repeat: none;\n"]);return Ie=function(){return e},e}function Ge(){var e=Object(v.a)(["\n  position: relative;\n"]);return Ge=function(){return e},e}function Ce(){var e=Object(v.a)(["\n  height: 10vh;\n"]);return Ce=function(){return e},e}function Be(){var e=Object(v.a)(["\n  height: 10vh;\n  font-family: monospace;\n  font-size: 1.8em;\n  font-weight: bold;\n"]);return Be=function(){return e},e}function We(){var e=Object(v.a)(["\n  width: 100%;\n  margin: 0px;\n"]);return We=function(){return e},e}function He(){var e=Object(v.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n"]);return He=function(){return e},e}var Ue,ze=m.a.div(He()),Fe=Object(m.a)(ke)(We()),Ne=Object(m.a)(Fe)(Be()),qe=Object(m.a)(Fe)(Ce()),Ke=m.a.div(Ge()),Ye=m.a.div(Ie(),function(e){return e.url}),Ve=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.gm,i=t.store,r=this.props.store,o=r.world,l=r.level,s=r.secondsRemaining,c=r.secondsElapsed,u=i.world?X[i.world.difficulty].overlay:"";return a.a.createElement(ze,null,a.a.createElement(Ne,null,a.a.createElement(Le,null,a.a.createElement("div",null,"Level ",l+1," / ",o&&(o.isInfinite()?"\u221e":o.totalLevels))),a.a.createElement(Le,null,a.a.createElement("div",null,o&&o.isInfinite()?s:c,"s"))),a.a.createElement(Ke,{onTouchStart:n.onTouchStart},this.props.children,a.a.createElement(Ye,{url:u})),a.a.createElement(qe,null,a.a.createElement(Le,null,a.a.createElement(Re,{onClick:n.clickReset},"reset")),a.a.createElement(Le,null,a.a.createElement(Re,{onClick:function(){return e.props.toggleOptions()}},"options"))))}}]),t}(a.a.Component),Je=Object(s.b)(function(e){return{store:e}},{toggleOptions:ue})(Ve);function Xe(){var e=Object(v.a)(["\n  font-size: 0.8em;\n"]);return Xe=function(){return e},e}function Qe(){var e=Object(v.a)(["\n  font-weight: bold;\n  text-transform: uppercase;\n"]);return Qe=function(){return e},e}function Ze(){var e=Object(v.a)(["\n  justify-content: center;\n  align-items: center;\n  flex-wrap: wrap;\n"]);return Ze=function(){return e},e}var $e,et=Object(m.a)(ke)(Ze()),tt=m.a.span(Qe()),nt=m.a.span(Xe()),it=(Ue={},Object(p.a)(Ue,T.Easy,!1),Object(p.a)(Ue,T.Medium,!1),Object(p.a)(Ue,T.Hard,!1),Object(p.a)(Ue,T.Infinite,!1),Ue),rt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state=Object(U.a)({},it),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.reset()}},{key:"reset",value:function(){var e=this;this.setState(Object(U.a)({},it),function(){e.props.gm.worldLoader.loaders.forEach(function(t){t.onLoad.then(function(){q.loaded.then(function(){e.setState(Object(p.a)({},t.difficulty,!0))})})})})}},{key:"loadWorld",value:function(e){e.loaded&&(this.props.gm.setWorld(e),this.reset())}},{key:"render",value:function(){var e=this,t=this.props.store,n=this.state,i=this.props.gm.worldLoader;if(t.world)return"";var r=[T.Easy,T.Medium,T.Hard,T.Infinite];return a.a.createElement(Pe,null,a.a.createElement(Ae,null),a.a.createElement(et,null,r.map(function(e){return i.getLoaderByDifficulty(e)}).map(function(t){return a.a.createElement(Se,{key:t.difficulty},a.a.createElement(Me,null,a.a.createElement(ke,null,a.a.createElement(tt,null,t.displayName())),a.a.createElement(ke,null,n[t.difficulty]?a.a.createElement(Re,{onClick:function(){return e.loadWorld(t)}},"PLAY"):a.a.createElement(De,null,"loading")),a.a.createElement(ke,null,a.a.createElement(nt,null,t.isInfinite()?"Limited Time":t.totalLevels+" Levels"))))})),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleMusic},"music is ",this.props.store.audioPlaying?"on":"off")),a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleOptions},"options")))))}}]),t}(a.a.Component),at=Object(s.b)(function(e){return{store:e}},{toggleMusic:ce,toggleOptions:ue})(rt),ot=function(e){function t(){var e,n;Object(c.a)(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(n=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).onReset=function(){n.props.gm.unsetWorld()},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.gm,i=t.store;return i.showOptions?a.a.createElement(Pe,null,a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Te,null," OPTIONS ")),a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleMusic},"music is ",this.props.store.audioPlaying?"on":"off")),a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleDrawGrid},"grid is ",this.props.store.shouldDrawGrid?"on":"off")),i.isMobile&&a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleDrawTouch},"touch indicators are ",this.props.store.shouldDrawTouch?"on":"off")))),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleHow2Play},"how to play")),a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleAbout},"about")))),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleOptions},i.world?"back to game":"back to menu")),i.world&&a.a.createElement(xe,null,a.a.createElement(Re,{onClick:function(){n.unsetWorld(),e.props.toggleOptions()}},"quit to menu"))))):""}}]),t}(a.a.Component),lt=Object(s.b)(function(e){return{store:e}},{toggleAbout:le,toggleDrawGrid:function(){return{type:"TOGGLE_DRAW_GRID",payload:{}}},toggleDrawTouch:function(){return{type:"TOGGLE_DRAW_TOUCH",payload:{}}},toggleHow2Play:se,toggleMusic:ce,toggleOptions:ue})(ot),st=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.gm,n=e.store,i=n.world,r=n.isGameOver;return i&&r?a.a.createElement(Pe,null,a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Te,null,i.isInfinite()?"GAME OVER!":"YOU WIN!")),a.a.createElement(xe,null,a.a.createElement("img",{alt:"",src:q.igloo.default.url}),a.a.createElement("img",{className:"rotate",alt:"",src:q.heroLeft.default.url})),i.isInfinite()?a.a.createElement("div",null,a.a.createElement(xe,null,"You managed to complete ",n.level-1," levels.")):a.a.createElement("div",null,a.a.createElement(xe,null,"You managed to beat ",i.displayName()," in ",n.secondsElapsed," seconds."),a.a.createElement(xe,null,"Try to beat it faster or play a higher difficulty!")),a.a.createElement(xe,null,a.a.createElement(Re,{onClick:function(){return t.unsetWorld()}},"MENU"))))):""}}]),t}(a.a.Component),ct=Object(s.b)(function(e){return{store:e}})(st),ut={ArrowDown:i.Down,ArrowLeft:i.Left,ArrowRight:i.Right,ArrowUp:i.Up},ht=($e={},Object(p.a)($e,i.Down,q.heroRight),Object(p.a)($e,i.Left,q.heroLeft),Object(p.a)($e,i.Right,q.heroRight),Object(p.a)($e,i.Up,q.heroLeft),$e),dt=new Error("canvas is not loaded yet"),ft=function(){function e(){var t=this;Object(c.a)(this,e),this.worldLoader=void 0,this.dispatch=he.dispatch,this.isDebug=window.location.href.includes("localhost"),this.worldDimensions=void 0,this.canvasDimensions=void 0,this.canvasElm=void 0,this.ctx=void 0,this.world=void 0,this.stopwatch=new S,this.currentLevel=void 0,this.currentLevelIndex=0,this.spriteFacing=q.heroRight,this.travelAnimations=[],this.touchAnimations=[],this.clearAnimations=[],this.touchPolygonByMove={},this.frameTick=0,this.clickReset=function(){t.currentLevel&&t.currentLevel.reset()},this.onTouchStart=function(e){var n=e.nativeEvent.touches[0],r=e.target.getBoundingClientRect(),a=n.clientX-r.left,o=n.clientY-r.top;if(!(.25*r.width<a&&a<.75*r.width&&.25*r.height<o&&o<.75*r.height)){var l=a/r.width,s=o/r.height,c=l>s,u=l+s<1,h=u&&c&&i.Up||!u&&c&&i.Right||!u&&!c&&i.Down||u&&!c&&i.Left;h&&t.handleMove(h)}},this.clickUp=function(){t.handleMove(i.Up)},this.clickDown=function(){t.handleMove(i.Down)},this.clickLeft=function(){t.handleMove(i.Left)},this.clickRight=function(){t.handleMove(i.Right)};var n=this.isDebug;n&&(window.DEBUG=this);var r=.8*document.body.clientHeight,a=document.body.clientWidth,o=r>a?new j(8,10):new j(10,8);this.worldDimensions=o,this.worldLoader=new H(this.worldDimensions);for(var l=r,s=l*o.x/o.y;s>a;)s=(l-=1)*o.x/o.y;this.canvasDimensions=new j(s,l),window.addEventListener("keydown",function(e){var i=ut[e.code]||void 0;i&&t.handleMove(i),"KeyR"===e.code&&t.clickReset(),"KeyN"===e.code&&n&&t.nextLevel()}),this.loop()}return Object(u.a)(e,[{key:"setup",value:function(e){var t;this.canvasElm=e,e.width=this.canvasDimensions.x,e.height=this.canvasDimensions.y,this.ctx=e.getContext("2d");var n=e.width/4,r=e.height/4,a=new j(-n,-r),o=new j(n,r),l=new j(5*n,-r),s=new j(3*n,r),c=new j(-n,5*r),u=new j(n,3*r),h=new j(5*n,5*r),d=new j(3*n,3*r);this.touchPolygonByMove=(t={},Object(p.a)(t,i.Left,[a,o,u,c]),Object(p.a)(t,i.Right,[l,s,d,h]),Object(p.a)(t,i.Up,[a,o,s,l]),Object(p.a)(t,i.Down,[c,u,d,h]),t)}},{key:"setWorld",value:function(e){this.worldLoader=new H(this.worldDimensions),this.world=e,this.currentLevelIndex=0,this.stopwatch=e.createStopwatch(),this.nextLevel(),this.dispatch(oe(e))}},{key:"unsetWorld",value:function(){this.world=void 0,this.dispatch(oe(void 0))}},{key:"triggerGameOver",value:function(){this.world=void 0,this.dispatch({type:"SET_GAME_OVER",payload:{}})}},{key:"handleMove",value:function(e){var t=this.currentLevel;if(t){var n=t.moveHero(e);this.spriteFacing=[i.Left,i.Right].includes(e)?ht[e]:this.spriteFacing,this.animateMove(e,n,this.spriteFacing),t.level.isWinningPoint(n.point)&&this.nextLevel()}}},{key:"nextLevel",value:function(){var e=Object(A.a)(R.a.mark(function e(){var t,n,i;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.currentLevelIndex,n=this.world){e.next=3;break}throw new Error("this should be impossible");case 3:return e.next=5,n.loadLevel(t);case 5:i=e.sent,this.currentLevel=i&&new k(i),this.currentLevel?(console.log(this.currentLevel.soln.printMoves()),this.dispatch({type:"SET_LEVEL",payload:{level:this.currentLevelIndex}}),this.currentLevelIndex+=1,this.stopwatch.addTime(1e3*(n.progression.secondsPerLevel||0)),this.travelAnimations=[],this.clearAnimations.push({origin:this.currentLevel.level.start,stopwatch:new S(500)},{origin:this.currentLevel.level.win,stopwatch:new S(500)})):this.triggerGameOver();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loop",value:function(){var e=Object(A.a)(R.a.mark(function e(){var t,n,i=this;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.world,n=this.stopwatch,!t){e.next=7;break}return e.next=4,this.draw();case 4:t.isInfinite()?(t.generateLevels(),n.formatRemaining()!==he.getState().secondsRemaining&&this.dispatch(ae(n)),n.getRemaining()<0&&this.triggerGameOver()):n.formatElapsed()!==he.getState().secondsElapsed&&this.dispatch(ae(n)),e.next=8;break;case 7:he.getState().isGameOver||this.worldLoader.loadInBackground();case 8:window.requestAnimationFrame(function(){return i.loop()});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"animateMove",value:function(e,t,n){var i,r=t.traveled.slice(0,-1).map(function(e,t,i){return{facing:n,stopwatch:new S(1e3*(1+t/i.length)),traveled:e}});(i=this.travelAnimations).push.apply(i,Object(g.a)(r)),he.getState().shouldDrawTouch&&this.touchAnimations.push({move:e,stopwatch:new S(200)})}},{key:"drawSprite",value:function(e,t,n,i){var r=this.canvasElm,a=this.ctx,o=this.currentLevel;if(r&&a&&o){var l=r.width,s=r.height,c=l/o.level.width,u=s/o.level.height;i=i||1,a.drawImage(e.atFrame(this.frameTick).image,t*c+c*(1-i)/2,n*u+u*(1-i)/2,c*i,u*i)}}},{key:"drawSpriteWithOpacity",value:function(e,t,n,i,r){var a=this.ctx;if(!a)throw dt;var o=a.globalAlpha;a.globalAlpha=e,this.drawSprite(t,n,i,r),a.globalAlpha=o}},{key:"draw",value:function(){var e=Object(A.a)(R.a.mark(function e(){var t,n,i,r,a,o,l,s,c,u,h,d,f,v,m=this;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.canvasElm,n=this.ctx,i=this.currentLevel,r=this.world,a=this.touchPolygonByMove,t&&n){e.next=3;break}return e.abrupt("return");case 3:return o=t.width,l=t.height,e.next=6,q.loaded;case 6:if(i&&r){e.next=8;break}return e.abrupt("return");case 8:for(this.frameTick=Math.floor(r.progression.boilFps*(new Date).getTime()/1e3),s=o/i.level.width,c=l/i.level.height,u=X[r.difficulty],n.fillStyle=V,n.fillRect(0,0,o,l),h=0;h<i.level.height;h++)for(d=0;d<i.level.width;d++)this.drawSprite(u.ground,d,h);if(this.touchAnimations=this.touchAnimations.filter(function(e){return e.stopwatch.getRemaining()>0}),this.touchAnimations.forEach(function(e){var t=e.move,i=e.stopwatch,r=a[t],o=i.getPercent();n.strokeStyle="rgba(100, 100, 100, ".concat(o,")"),n.fillStyle="rgba(255, 255, 255, ".concat(o,")"),n.beginPath(),n.moveTo(r[0].x,r[0].y),r.reverse().forEach(function(e){n.lineTo(e.x,e.y)}),n.fill(),n.stroke()}),he.getState().shouldDrawGrid){for(n.strokeStyle=u.gridColor,f=1;f<i.level.height;f++)n.beginPath(),n.moveTo(0,f*c),n.lineTo(o,f*c),n.stroke();for(v=1;v<i.level.width;v++)n.beginPath(),n.moveTo(v*s,0),n.lineTo(v*s,l),n.stroke()}i.level.blocks.forEach(function(e){var t=(e.x+e.y)%2===0?q.treeLight:q.treeHeavy;m.drawSprite(t,e.x,e.y)}),this.travelAnimations=this.travelAnimations.filter(function(e){return e.stopwatch.getRemaining()>0}),this.travelAnimations.forEach(function(e){var t=e.facing,n=e.traveled,i=.7*e.stopwatch.getPercent();m.drawSpriteWithOpacity(i,t,n.point.x,n.point.y,1.2)}),this.clearAnimations=this.clearAnimations.filter(function(e){return e.stopwatch.getRemaining()>0}),this.clearAnimations.forEach(function(e){var t=e.origin,i=e.stopwatch,r=Math.max(o,l);n.fillStyle="white",n.beginPath(),n.arc((t.x+.5)*s,(t.y+.5)*c,r*i.getPercent(),0,2*Math.PI,!1),n.fill()}),this.drawSprite(q.igloo,i.level.win.x,i.level.win.y),this.drawSprite(this.spriteFacing,i.hero.point.x,i.hero.point.y,1.2);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),vt=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.store,t=e.showHow2Play,n=e.isMobile,i=e.showTutorial;return t?a.a.createElement(Pe,null,i&&a.a.createElement(Ae,null),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Te,null," HOW TO PLAY ")),a.a.createElement(xe,null,n?"Tap the edges of the snow field to move (left, right, up, down)":"Use the arrow keys to move (left, right, up, down)"),a.a.createElement(xe,null,"Navigate your snowman across the slippery ice to the igloo!"),a.a.createElement(xe,null,"If you get stuck, press the RESET button",!n&&" or R key","."),i&&a.a.createElement(xe,null,"You can view these instructions again from the options menu."))),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleHow2Play},i?"ok":"back"))))):""}}]),t}(a.a.Component),mt=Object(s.b)(function(e){return{store:e}},{toggleHow2Play:se})(vt),pt=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.store.showAbout?a.a.createElement(Pe,null,a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Te,null," ABOUT ")),a.a.createElement(xe,null,a.a.createElement("div",null,"made by ",a.a.createElement("a",{href:"https://www.mpaulweeks.com"},"mpaulweeks"))),a.a.createElement(xe,null,a.a.createElement(Le,null,a.a.createElement("div",null,"original assets by ",a.a.createElement("a",{href:"https://www.kenney.nl"},"Kenney")),a.a.createElement("div",null,"with edits by ",a.a.createElement("a",{href:"https://amyjxu.me"},"Amy Xu")))),a.a.createElement(xe,null,a.a.createElement("div",null,"music by ",a.a.createElement("a",{href:"https://visager.bandcamp.com/album/songs-from-an-unmade-world"},"Visager"))),a.a.createElement(xe,null,a.a.createElement("div",null,"\u2744\ufe0f",a.a.createElement("i",null,"August 2019")," \u2744\ufe0f")))),a.a.createElement(ke,null,a.a.createElement(Se,null,a.a.createElement(xe,null,a.a.createElement(Re,{onClick:this.props.toggleAbout},"back"))))):""}}]),t}(a.a.Component),gt=Object(s.b)(function(e){return{store:e}},{toggleAbout:le})(pt);function bt(){var e=Object(v.a)(["\n  border-radius: 5%;\n"]);return bt=function(){return e},e}function wt(){var e=Object(v.a)(["\n  max-width: 50vh;\n  margin: 0px auto;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n"]);return wt=function(){return e},e}var yt=m.a.div(wt()),Ot=m.a.canvas(bt()),Et=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).canvasRef=void 0,n.gm=new ft,n.canvasRef=a.a.createRef(),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e&&this.gm.setup(e)}},{key:"render",value:function(){var e=this.gm;return a.a.createElement(yt,null,a.a.createElement(ee,null),a.a.createElement(Je,{gm:e},a.a.createElement(Ot,{ref:this.canvasRef})),a.a.createElement(at,{gm:e}),a.a.createElement(ct,{gm:e}),a.a.createElement(lt,{gm:e}),a.a.createElement(mt,null),a.a.createElement(gt,null))}}]),t}(a.a.Component),kt=Object(s.b)(function(e){return{store:e}})(Et);n(43);l.a.render(a.a.createElement(s.a,{store:he},a.a.createElement(kt,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.70c6a854.chunk.js.map