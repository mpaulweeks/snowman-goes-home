{"version":3,"sources":["../../utils/dist/index.js","../../utils/dist/level.js","../../utils/dist/moves.js","../../utils/dist/point.js","../../utils/dist/gen.js","manager.ts","GameView.tsx","App.jsx","index.js"],"names":["__export","m","p","exports","hasOwnProperty","Object","defineProperty","value","__webpack_require__","moves_1","Level","width","height","start","win","blocks","this","prototype","isWinningPoint","loc","equals","isIllegalPoint","some","b","x","y","applyMove","moveHistory","move","moves","length","current","point","next","clone","Move","Left","Right","Up","Down","solve","visited","queue","MoveHistory","getNextMoves","slice","counter","shift","key","toString","push","apply","print","_a","grid","_loop_1","row","_loop_2","_char","forEach","map","join","SolvableLevel","level","soln","PlayableLevel","solved","hero","reset","moveHero","addMove","newPoint","updatePoint","Moves","keys","filter","k","isNaN","Number","last","_this","concat","printMoves","Point","other","randomWithin","exclude","excludeKeys","reduce","Math","floor","random","fromString","str","parts","split","parseFloat","level_1","point_1","Generator","blockPercent","minMoves","tryGenerateLevel","bound","n","arr","i","range","_","solution","generateLevels","max","tries","levels","l","moveMap","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","loadImage","url","img","Image","state","image","loaded","Promise","resolve","reject","onload","src","GameManager","canvasElm","classCallCheck","ctx","currentLevel","sprites","ready","getContext","allSprites","values","all","s","then","window","addEventListener","e","code","undefined","handleMove","draw","newLevel","createClass","console","log","_draw","asyncToGenerator","regenerator_default","a","mark","_callee","blockWidth","blockHeight","wrap","_context","prev","fillStyle","fillRect","font","fillText","abrupt","strokeStyle","beginPath","moveTo","lineTo","stroke","block","drawImage","stop","arguments","Canvas","styled","canvas","_templateObject","GameView","_React$Component","props","possibleConstructorReturn","getPrototypeOf","call","canvasRef","manager","React","createRef","inherits","react_default","createElement","ref","Component","Container","div","App_templateObject","ReactDOM","render","GameView_GameView","document","getElementById"],"mappings":"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","file":"static/js/main.da4a01ac.chunk.js","sourcesContent":["\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__export(require(\"./gen\"));\n\n__export(require(\"./level\"));\n\n__export(require(\"./moves\"));\n\n__export(require(\"./point\"));","\"use strict\"; // https://repl.it/@mpaulweeks/ice\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar moves_1 = require(\"./moves\");\n\nvar Level =\n/** @class */\nfunction () {\n  function Level(width, height, start, win, blocks) {\n    this.width = width;\n    this.height = height;\n    this.start = start;\n    this.win = win;\n    this.blocks = blocks;\n  }\n\n  Level.prototype.isWinningPoint = function (loc) {\n    return this.win.equals(loc);\n  };\n\n  Level.prototype.isIllegalPoint = function (loc) {\n    var _a = this,\n        blocks = _a.blocks,\n        width = _a.width,\n        height = _a.height;\n\n    var hitBlock = blocks.some(function (b) {\n      return b.equals(loc);\n    });\n    return hitBlock || loc.x < 0 || loc.x >= width || loc.y < 0 || loc.y >= height;\n  };\n\n  Level.prototype.applyMove = function (moveHistory) {\n    var move = moveHistory.moves[moveHistory.moves.length - 1];\n    var current = moveHistory.point;\n\n    while (true) {\n      var next = current.clone();\n      if (move === moves_1.Move.Left) next.x--;else if (move === moves_1.Move.Right) next.x++;else if (move === moves_1.Move.Up) next.y--;else if (move === moves_1.Move.Down) next.y++;else throw \"unexpected move: \" + move;\n\n      if (this.isWinningPoint(next)) {\n        return next;\n      }\n\n      if (this.isIllegalPoint(next)) {\n        return current;\n      }\n\n      current = next;\n    }\n  };\n\n  Level.prototype.solve = function () {\n    var spawn = new moves_1.MoveHistory(this.start, []);\n    var visited = {};\n    var queue = spawn.getNextMoves().slice();\n    var counter = 0;\n\n    while (counter < 8000 && queue.length) {\n      counter++;\n      var next = queue.shift();\n      next.point = this.applyMove(next);\n\n      if (this.isWinningPoint(next.point)) {\n        return next;\n      }\n\n      var key = next.point.toString();\n\n      if (!visited[key]) {\n        queue.push.apply(queue, next.getNextMoves());\n        visited[key] = next;\n      }\n    }\n\n    return null;\n  };\n\n  Level.prototype.print = function () {\n    var _a = this,\n        width = _a.width,\n        height = _a.height,\n        start = _a.start,\n        win = _a.win,\n        blocks = _a.blocks;\n\n    var grid = [];\n\n    var _loop_1 = function _loop_1(y) {\n      var row = [];\n\n      var _loop_2 = function _loop_2(x) {\n        var _char = '_';\n\n        if (win.x === x && win.y === y) {\n          _char = 'W';\n        }\n\n        if (start.x === x && start.y === y) {\n          _char = 'S';\n        }\n\n        blocks.forEach(function (b) {\n          if (b.x === x && b.y === y) {\n            _char = '0';\n          }\n        });\n        row.push(_char);\n      };\n\n      for (var x = 0; x < width; x++) {\n        _loop_2(x);\n      }\n\n      grid.push(row);\n    };\n\n    for (var y = 0; y < height; y++) {\n      _loop_1(y);\n    }\n\n    return grid.map(function (row) {\n      return row.join('');\n    }).join('\\n');\n  };\n\n  return Level;\n}();\n\nexports.Level = Level;\n\nvar SolvableLevel =\n/** @class */\nfunction () {\n  function SolvableLevel(level, soln) {\n    this.level = level;\n    this.soln = soln;\n  }\n\n  return SolvableLevel;\n}();\n\nexports.SolvableLevel = SolvableLevel;\n\nvar PlayableLevel =\n/** @class */\nfunction () {\n  function PlayableLevel(solved) {\n    this.level = solved.level;\n    this.soln = solved.soln;\n    this.hero = new moves_1.MoveHistory(this.level.start, []);\n  }\n\n  PlayableLevel.prototype.reset = function () {\n    this.hero = new moves_1.MoveHistory(this.level.start, []);\n  };\n\n  PlayableLevel.prototype.moveHero = function (move) {\n    var _a = this,\n        level = _a.level,\n        hero = _a.hero;\n\n    hero.addMove(move);\n    var newPoint = level.applyMove(hero);\n    hero.updatePoint(newPoint);\n  };\n\n  return PlayableLevel;\n}();\n\nexports.PlayableLevel = PlayableLevel;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar Move;\n\n(function (Move) {\n  Move[Move[\"Up\"] = 1] = \"Up\";\n  Move[Move[\"Down\"] = 2] = \"Down\";\n  Move[Move[\"Left\"] = 3] = \"Left\";\n  Move[Move[\"Right\"] = 4] = \"Right\";\n})(Move = exports.Move || (exports.Move = {}));\n\n;\nexports.Moves = Object.keys(Move).filter(function (k) {\n  return isNaN(Number(k));\n}).map(function (k) {\n  return Move[k];\n});\n\nvar MoveHistory =\n/** @class */\nfunction () {\n  function MoveHistory(point, moves) {\n    this.point = point;\n    this.moves = moves;\n  }\n\n  MoveHistory.prototype.last = function () {\n    return this.moves[this.moves.length - 1];\n  };\n\n  MoveHistory.prototype.addMove = function (move) {\n    this.moves.push(move);\n  };\n\n  MoveHistory.prototype.updatePoint = function (point) {\n    // todo point history?\n    this.point = point;\n  };\n\n  MoveHistory.prototype.getNextMoves = function () {\n    var _this = this;\n\n    var last = this.last();\n    return exports.Moves.filter(function (m) {\n      return m !== last;\n    }).map(function (m) {\n      return new MoveHistory(_this.point, _this.moves.concat([m]));\n    });\n  };\n\n  MoveHistory.prototype.printMoves = function () {\n    return this.moves.map(function (k) {\n      return Move[k];\n    }).join(', ');\n  };\n\n  return MoveHistory;\n}();\n\nexports.MoveHistory = MoveHistory;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Point =\n/** @class */\nfunction () {\n  function Point(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  Point.prototype.clone = function () {\n    return new Point(this.x, this.y);\n  };\n\n  Point.prototype.toString = function () {\n    return this.x + \",\" + this.y;\n  };\n\n  Point.prototype.equals = function (other) {\n    return this.toString() === other.toString();\n  };\n\n  Point.prototype.randomWithin = function (exclude) {\n    var newPoint;\n    var excludeKeys = exclude.reduce(function (map, p) {\n      map[p.toString()] = true;\n      return map;\n    }, {});\n\n    while (!newPoint || excludeKeys[newPoint.toString()]) {\n      newPoint = new Point(Math.floor(Math.random() * this.x), Math.floor(Math.random() * this.y));\n    }\n\n    return newPoint;\n  };\n\n  Point.fromString = function (str) {\n    var parts = str.split(',');\n    return new Point(parseFloat(parts[0]), parseFloat(parts[1]));\n  };\n\n  return Point;\n}();\n\nexports.Point = Point;\n;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar level_1 = require(\"./level\");\n\nvar point_1 = require(\"./point\");\n\nfunction range(n) {\n  var arr = [];\n\n  for (var i = 0; i < n; i++) {\n    arr.push(i);\n  }\n\n  return arr;\n}\n\nvar Generator =\n/** @class */\nfunction () {\n  function Generator(width, height, blockPercent, minMoves) {\n    this.width = width;\n    this.height = height;\n    this.blockPercent = blockPercent;\n    this.minMoves = minMoves;\n  }\n\n  Generator.prototype.tryGenerateLevel = function () {\n    var _a = this,\n        width = _a.width,\n        height = _a.height,\n        blockPercent = _a.blockPercent,\n        minMoves = _a.minMoves;\n\n    var bound = new point_1.Point(width, height);\n    var win = bound.randomWithin([]);\n    var start = bound.randomWithin([win]);\n    var blocks = range(width * height * blockPercent).map(function (_) {\n      return bound.randomWithin([win, start]);\n    });\n    var level = new level_1.Level(width, height, start, win, blocks);\n    var solution = level.solve();\n    return solution && solution.moves.length > minMoves ? new level_1.SolvableLevel(level, solution) : null;\n  };\n\n  Generator.prototype.generateLevels = function (max, tries) {\n    var levels = [];\n\n    for (var i = 0; levels.length < max && i < tries; i++) {\n      var l = this.tryGenerateLevel();\n\n      if (l) {\n        levels.push(l);\n      }\n    }\n\n    return levels;\n  };\n\n  return Generator;\n}();\n\nexports.Generator = Generator;","import { Generator, Move, PlayableLevel } from \"ice-puzzle-utils\";\n\nconst moveMap: { [code: string]: Move } = {\n  'ArrowLeft': Move.Left,\n  'ArrowRight': Move.Right,\n  'ArrowUp': Move.Up,\n  'ArrowDown': Move.Down,\n};\n\ninterface Sprite {\n  image: HTMLImageElement;\n  loaded: Promise<boolean>;\n}\n\ninterface Sprites {\n  hero: Sprite;\n};\n\nfunction loadImage(url: string) {\n  const img = new Image();\n  const state: Sprite = {\n    image: img,\n    loaded: new Promise((resolve, reject) => {\n      img.onload = () => resolve(true);\n    }),\n  };\n  img.src = url;\n  return state;\n}\n\nexport class GameManager {\n  canvasElm: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n  currentLevel: (PlayableLevel | undefined);\n  sprites: Sprites;\n  ready: Promise<boolean>;\n\n  constructor(canvasElm: HTMLCanvasElement) {\n    this.canvasElm = canvasElm;\n    canvasElm.width = 800;\n    canvasElm.height = 600;\n    this.ctx = canvasElm.getContext('2d') as CanvasRenderingContext2D;\n\n    this.sprites = {\n      hero: loadImage('img/ice_blue.png'),\n    };\n    const allSprites = Object.values(this.sprites);\n    this.ready = Promise.all(allSprites.map(s => s.loaded)).then(() => true);\n\n    window.addEventListener('keydown', e => {\n      // console.log(e);\n      const move = moveMap[e.code] || undefined;\n      if (move) {\n        this.handleMove(move);\n      }\n      if (e.code === 'KeyR') {\n        this.currentLevel && this.currentLevel.reset();\n        this.draw();\n      }\n      if (e.code === 'KeyN') {\n        this.newLevel();\n      }\n    });\n  }\n\n  handleMove(move: Move) {\n    const { currentLevel } = this;\n    if (!currentLevel) {\n      return;\n    }\n    currentLevel.moveHero(move);\n    this.draw();\n  }\n  newLevel() {\n    const generator = new Generator(10, 8, Math.random() * 0.1 + 0.2, Math.random() * 10 + 5);\n    const newLevel = generator.generateLevels(1, 1000)[0];\n    if (newLevel) {\n      console.log('solution:', newLevel.soln.printMoves());\n    }\n    this.currentLevel = newLevel && new PlayableLevel(newLevel);\n    this.draw();\n  }\n\n  async draw() {\n    const { canvasElm, ctx, currentLevel, ready, sprites } = this;\n    const { width, height } = canvasElm;\n\n    await ready;\n\n    ctx.fillStyle = 'black';\n    ctx.fillRect(0, 0, width, height);\n\n    if (!currentLevel) {\n      ctx.font = '20px monospace';\n      ctx.fillStyle = 'white';\n      ctx.fillText('making level failed, try again', 100, 100);\n      return;\n    }\n\n    const blockWidth = width / currentLevel.level.width;\n    const blockHeight = height / currentLevel.level.height;\n\n    // grid\n    ctx.strokeStyle = 'white';\n    for (let y = 0; y < currentLevel.level.height; y++) {\n      ctx.beginPath();\n      ctx.moveTo(0, y * blockHeight);\n      ctx.lineTo(width, y * blockHeight);\n      ctx.stroke();\n    }\n    for (let x = 0; x < currentLevel.level.width; x++) {\n      ctx.beginPath();\n      ctx.moveTo(x * blockWidth, 0);\n      ctx.lineTo(x * blockWidth, height);\n      ctx.stroke();\n    }\n\n    ctx.fillStyle = 'grey';\n    ctx.fillRect(currentLevel.level.start.x * blockWidth, currentLevel.level.start.y * blockHeight, blockWidth, blockHeight);\n\n    ctx.fillStyle = 'lightgreen';\n    ctx.fillRect(currentLevel.level.win.x * blockWidth, currentLevel.level.win.y * blockHeight, blockWidth, blockHeight);\n\n    ctx.fillStyle = 'lightgrey';\n    currentLevel.level.blocks.forEach(block => {\n      ctx.fillRect(block.x * blockWidth, block.y * blockHeight, blockWidth, blockHeight);\n    });\n\n    ctx.drawImage(\n      sprites.hero.image,\n      currentLevel.hero.point.x * blockWidth + blockWidth * 0.2,\n      currentLevel.hero.point.y * blockHeight + blockHeight * 0.2,\n      blockWidth * 0.6,\n      blockHeight * 0.6\n    );\n  }\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { GameManager } from './manager';\n\nconst Canvas = styled.canvas`\n  width: 800px;\n  height: 600px;\n`;\n\ninterface Props { }\n\nexport class GameView extends React.Component<Props> {\n  canvasRef: React.RefObject<HTMLCanvasElement>;\n  manager: (GameManager | undefined) = undefined;\n\n  constructor(props: Props) {\n    super(props);\n    this.canvasRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const canvasElm = this.canvasRef.current;\n    if (canvasElm) {\n      this.manager = new GameManager(canvasElm);\n      this.manager.newLevel();\n    }\n  }\n\n  render() {\n    return (\n      <Canvas ref={this.canvasRef} >\n      </Canvas>\n    );\n  }\n}\n","import React from 'react';\nimport { GameView } from './GameView';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  padding: 2rem;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n`;\n\nexport function App() {\n  return (\n    <Container>\n      <h1>\n        ice slide puzzle game\n      </h1>\n      <p>\n        use arrow keys to move, R to restart, and N to make new level\n      </p>\n      <GameView />\n    </Container>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}