(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(29)),r(n(12)),r(n(13)),r(n(14))},12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),i=function(){function e(e,t,n,r,i){this.width=e,this.height=t,this.start=n,this.win=r,this.blocks=i}return e.prototype.isWinningPoint=function(e){return this.win.equals(e)},e.prototype.isIllegalPoint=function(e){var t=this.blocks,n=this.width,r=this.height;return t.some(function(t){return t.equals(e)})||e.x<0||e.x>=n||e.y<0||e.y>=r},e.prototype.applyMove=function(e){for(var t=e.moves[e.moves.length-1],n=e.point;;){var i=n.clone();if(t===r.Move.Left)i.x--;else if(t===r.Move.Right)i.x++;else if(t===r.Move.Up)i.y--;else{if(t!==r.Move.Down)throw"unexpected move: "+t;i.y++}if(this.isWinningPoint(i))return i;if(this.isIllegalPoint(i))return n;n=i}},e.prototype.solve=function(){for(var e={},t=new r.MoveHistory(this.start,[]).getNextMoves().slice(),n=0;n<8e3&&t.length;){n++;var i=t.shift();if(i.point=this.applyMove(i),this.isWinningPoint(i.point))return i;var o=i.point.toString();e[o]||(t.push.apply(t,i.getNextMoves()),e[o]=i)}return null},e.prototype.print=function(){for(var e=this,t=e.width,n=e.height,r=e.start,i=e.win,o=e.blocks,a=[],s=function(e){for(var n=[],s=function(t){var a="_";i.x===t&&i.y===e&&(a="W"),r.x===t&&r.y===e&&(a="S"),o.forEach(function(n){n.x===t&&n.y===e&&(a="0")}),n.push(a)},l=0;l<t;l++)s(l);a.push(n)},l=0;l<n;l++)s(l);return a.map(function(e){return e.join("")}).join("\n")},e}();t.Level=i;var o=function(){return function(e,t){this.level=e,this.soln=t}}();t.SolvableLevel=o;var a=function(){function e(e){this.level=e.level,this.soln=e.soln,this.hero=new r.MoveHistory(this.level.start,[])}return e.prototype.reset=function(){this.hero=new r.MoveHistory(this.level.start,[])},e.prototype.moveHero=function(e){var t=this.level,n=this.hero;n.addMove(e);var r=t.applyMove(n);n.updatePoint(r)},e}();t.PlayableLevel=a},13:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Right=4]="Right"}(r=t.Move||(t.Move={})),t.Moves=Object.keys(r).filter(function(e){return isNaN(Number(e))}).map(function(e){return r[e]});var i=function(){function e(e,t){this.point=e,this.moves=t}return e.prototype.last=function(){return this.moves[this.moves.length-1]},e.prototype.addMove=function(e){this.moves.push(e)},e.prototype.updatePoint=function(e){this.point=e},e.prototype.getNextMoves=function(){var n=this,r=this.last();return t.Moves.filter(function(e){return e!==r}).map(function(t){return new e(n.point,n.moves.concat([t]))})},e.prototype.printMoves=function(){return this.moves.map(function(e){return r[e]}).join(", ")},e}();t.MoveHistory=i},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.toString=function(){return this.x+","+this.y},e.prototype.equals=function(e){return this.toString()===e.toString()},e.prototype.randomWithin=function(t){for(var n,r=t.reduce(function(e,t){return e[t.toString()]=!0,e},{});!n||r[n.toString()];)n=new e(Math.floor(Math.random()*this.x),Math.floor(Math.random()*this.y));return n},e.fromString=function(t){var n=t.split(",");return new e(parseFloat(n[0]),parseFloat(n[1]))},e}();t.Point=r},22:function(e,t,n){e.exports=n(36)},29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),i=n(14);var o=function(){function e(e,t,n,r){this.width=e,this.height=t,this.blockPercent=n,this.minMoves=r}return e.prototype.tryGenerateLevel=function(){var e=this.width,t=this.height,n=this.blockPercent,o=this.minMoves,a=new i.Point(e,t),s=a.randomWithin([]),l=a.randomWithin([s]),u=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}(e*t*n).map(function(e){return a.randomWithin([s,l])}),c=new r.Level(e,t,l,s,u),h=c.solve();return h&&h.moves.length>o?new r.SolvableLevel(c,h):null},e.prototype.generateLevels=function(e,t){for(var n=[],r=0;n.length<e&&r<t;r++){var i=this.tryGenerateLevel();i&&n.push(i)}return n},e}();t.Generator=o},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(2),a=n.n(o),s=n(3),l=n(4),u=n(5),c=n(19),h=n(15),v=n(21),f=n(6),p=n(7),d=n.n(p),y=n(16),w=n(1),m={ArrowLeft:w.Move.Left,ArrowRight:w.Move.Right,ArrowUp:w.Move.Up,ArrowDown:w.Move.Down};function g(e){var t=new Image,n={image:t,loaded:new Promise(function(e,n){t.onload=function(){return e(!0)}})};return t.src=e,n}var M=function(){function e(t){var n=this;Object(l.a)(this,e),this.canvasElm=void 0,this.ctx=void 0,this.currentLevel=void 0,this.sprites=void 0,this.ready=void 0,this.canvasElm=t,t.width=800,t.height=600,this.ctx=t.getContext("2d"),this.sprites={hero:g("img/ice_blue.png")};var r=Object.values(this.sprites);this.ready=Promise.all(r.map(function(e){return e.loaded})).then(function(){return!0}),window.addEventListener("keydown",function(e){var t=m[e.code]||void 0;t&&n.handleMove(t),"KeyR"===e.code&&(n.currentLevel&&n.currentLevel.reset(),n.draw()),"KeyN"===e.code&&n.newLevel()})}return Object(u.a)(e,[{key:"handleMove",value:function(e){var t=this.currentLevel;t&&(t.moveHero(e),this.draw())}},{key:"newLevel",value:function(){var e=new w.Generator(10,8,.1*Math.random()+.2,10*Math.random()+5).generateLevels(1,1e3)[0];e&&console.log("solution:",e.soln.printMoves()),this.currentLevel=e&&new w.PlayableLevel(e),this.draw()}},{key:"draw",value:function(){var e=Object(y.a)(d.a.mark(function e(){var t,n,r,i,o,a,s,l,u,c,h;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.canvasElm,n=this.ctx,r=this.currentLevel,i=this.ready,o=this.sprites,a=t.width,s=t.height,e.next=4,i;case 4:if(n.fillStyle="black",n.fillRect(0,0,a,s),r){e.next=11;break}return n.font="20px monospace",n.fillStyle="white",n.fillText("making level failed, try again",100,100),e.abrupt("return");case 11:for(l=a/r.level.width,u=s/r.level.height,n.strokeStyle="white",c=0;c<r.level.height;c++)n.beginPath(),n.moveTo(0,c*u),n.lineTo(a,c*u),n.stroke();for(h=0;h<r.level.width;h++)n.beginPath(),n.moveTo(h*l,0),n.lineTo(h*l,s),n.stroke();n.fillStyle="grey",n.fillRect(r.level.start.x*l,r.level.start.y*u,l,u),n.fillStyle="lightgreen",n.fillRect(r.level.win.x*l,r.level.win.y*u,l,u),n.fillStyle="lightgrey",r.level.blocks.forEach(function(e){n.fillRect(e.x*l,e.y*u,l,u)}),n.drawImage(o.hero.image,r.hero.point.x*l+.2*l,r.hero.point.y*u+.2*u,.6*l,.6*u);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();function b(){var e=Object(s.a)(["\n  width: 800px;\n  height: 600px;\n"]);return b=function(){return e},e}var x=f.a.canvas(b()),L=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(h.a)(t).call(this,e))).canvasRef=void 0,n.manager=void 0,n.canvasRef=i.a.createRef(),n}return Object(v.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e&&(this.manager=new M(e),this.manager.newLevel())}},{key:"render",value:function(){return i.a.createElement(x,{ref:this.canvasRef})}}]),t}(i.a.Component);function k(){var e=Object(s.a)(["\n  padding: 2rem;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n"]);return k=function(){return e},e}var P=f.a.div(k());n(35);a.a.render(i.a.createElement(function(){return i.a.createElement(P,null,i.a.createElement("h1",null,"ice slide puzzle game"),i.a.createElement("p",null,"use arrow keys to move, R to restart, and N to make new level"),i.a.createElement(L,null))},null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.da4a01ac.chunk.js.map