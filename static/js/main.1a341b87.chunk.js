(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n(33)},32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var i,o=n(0),r=n.n(o),s=n(11),a=n.n(s),l=n(4),h=n(1),u=n(2),c=n(16),v=n(12),f=n(18),d=n(5),w=n(6),p=n.n(w),g=n(13),m=n(3);!function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Right=4]="Right"}(i||(i={}));var y=Object.keys(i).filter(function(e){return isNaN(Number(e))}).map(function(e){return i[e]}),k=function(){function e(t,n){Object(h.a)(this,e),this.point=void 0,this.moves=void 0,this.point=t,this.moves=n}return Object(u.a)(e,[{key:"last",value:function(){return this.moves[this.moves.length-1]}},{key:"addMove",value:function(e){this.moves.push(e)}},{key:"updatePoint",value:function(e){this.point=e}},{key:"getNextMoves",value:function(){var t=this,n=this.last();return y.filter(function(e){return e!==n}).map(function(n){return new e(t.point,[].concat(Object(m.a)(t.moves),[n]))})}},{key:"printMoves",value:function(){return this.moves.map(function(e){return i[e]}).join(", ")}}]),e}(),b=function(){function e(t,n,i,o,r){Object(h.a)(this,e),this.width=void 0,this.height=void 0,this.start=void 0,this.win=void 0,this.blocks=void 0,this.width=t,this.height=n,this.start=i,this.win=o,this.blocks=r}return Object(u.a)(e,[{key:"isWinningPoint",value:function(e){return this.win.equals(e)}},{key:"isIllegalPoint",value:function(e){var t=this.blocks,n=this.width,i=this.height;return t.some(function(t){return t.equals(e)})||e.x<0||e.x>=n||e.y<0||e.y>=i}},{key:"applyMove",value:function(e){for(var t=e.moves[e.moves.length-1],n=e.point;;){var o=n.clone();if(t===i.Left)o.x--;else if(t===i.Right)o.x++;else if(t===i.Up)o.y--;else{if(t!==i.Down)throw new Error("unexpected move: ".concat(t));o.y++}if(this.isWinningPoint(o))return o;if(this.isIllegalPoint(o))return n;n=o}}},{key:"solve",value:function(){for(var e=new k(this.start,[]),t={},n=Object(m.a)(e.getNextMoves()),i=0;i<8e3&&n.length;){i++;var o=n.shift();if(o.point=this.applyMove(o),this.isWinningPoint(o.point))return o;var r=o.point.toString();t[r]||(n.push.apply(n,Object(m.a)(o.getNextMoves())),t[r]=o)}return null}},{key:"print",value:function(){for(var e=this.width,t=this.height,n=this.start,i=this.win,o=this.blocks,r=[],s=function(t){for(var s=[],a=function(e){var r="_";i.x===e&&i.y===t&&(r="W"),n.x===e&&n.y===t&&(r="S"),o.forEach(function(n){n.x===e&&n.y===t&&(r="0")}),s.push(r)},l=0;l<e;l++)a(l);r.push(s)},a=0;a<t;a++)s(a);return r.map(function(e){return e.join("")}).join("\n")}}]),e}(),x=function e(t,n){Object(h.a)(this,e),this.level=void 0,this.soln=void 0,this.level=t,this.soln=n},j=function(){function e(t){Object(h.a)(this,e),this.level=void 0,this.soln=void 0,this.hero=void 0,this.level=t.level,this.soln=t.soln,this.hero=new k(this.level.start,[])}return Object(u.a)(e,[{key:"reset",value:function(){this.hero=new k(this.level.start,[])}},{key:"moveHero",value:function(e){var t=this.level,n=this.hero;n.addMove(e);var i=t.applyMove(n);n.updatePoint(i)}}]),e}(),O=function(){function e(t,n){Object(h.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(u.a)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"toString",value:function(){return"".concat(this.x,",").concat(this.y)}},{key:"equals",value:function(e){return this.toString()===e.toString()}},{key:"randomWithin",value:function(t){for(var n,i=t.reduce(function(e,t){return e[t.toString()]=!0,e},{});!n||i[n.toString()];)n=new e(Math.floor(Math.random()*this.x),Math.floor(Math.random()*this.y));return n}}],[{key:"fromString",value:function(t){var n=t.split(",");return new e(parseFloat(n[0]),parseFloat(n[1]))}}]),e}();var M=function(){function e(t,n,i,o){Object(h.a)(this,e),this.width=void 0,this.height=void 0,this.blockPercent=void 0,this.minMoves=void 0,this.width=t,this.height=n,this.blockPercent=i,this.minMoves=o}return Object(u.a)(e,[{key:"tryGenerateLevel",value:function(){var e=this.width,t=this.height,n=this.blockPercent,i=this.minMoves,o=new O(e,t),r=o.randomWithin([]),s=o.randomWithin([r]),a=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}(e*t*n).map(function(e){return o.randomWithin([r,s])}),l=new b(e,t,s,r,a),h=l.solve();return h&&h.moves.length>i?new x(l,h):null}},{key:"generateLevels",value:function(e,t){for(var n=[],i=0;n.length<e&&i<t;i++){var o=this.tryGenerateLevel();o&&n.push(o)}return n}}]),e}(),L={ArrowLeft:i.Left,ArrowRight:i.Right,ArrowUp:i.Up,ArrowDown:i.Down};function R(e){var t=new Image,n={image:t,loaded:new Promise(function(e,n){t.onload=function(){return e(!0)}})};return t.src=e,n}var E=function(){function e(t){var n=this;Object(h.a)(this,e),this.canvasElm=void 0,this.ctx=void 0,this.currentLevel=void 0,this.sprites=void 0,this.ready=void 0,this.canvasElm=t,t.width=800,t.height=600,this.ctx=t.getContext("2d"),this.sprites={hero:R("img/ice_blue.png")};var i=Object.values(this.sprites);this.ready=Promise.all(i.map(function(e){return e.loaded})).then(function(){return!0}),window.addEventListener("keydown",function(e){var t=L[e.code]||void 0;t&&n.handleMove(t),"KeyR"===e.code&&(n.currentLevel&&n.currentLevel.reset(),n.draw()),"KeyN"===e.code&&n.newLevel()})}return Object(u.a)(e,[{key:"handleMove",value:function(e){var t=this.currentLevel;t&&(t.moveHero(e),this.draw())}},{key:"newLevel",value:function(){var e=new M(10,8,.1*Math.random()+.2,10*Math.random()+5).generateLevels(1,1e3)[0];e&&console.log("solution:",e.soln.printMoves()),this.currentLevel=e&&new j(e),this.draw()}},{key:"draw",value:function(){var e=Object(g.a)(p.a.mark(function e(){var t,n,i,o,r,s,a,l,h,u,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.canvasElm,n=this.ctx,i=this.currentLevel,o=this.ready,r=this.sprites,s=t.width,a=t.height,e.next=4,o;case 4:if(n.fillStyle="black",n.fillRect(0,0,s,a),i){e.next=11;break}return n.font="20px monospace",n.fillStyle="white",n.fillText("making level failed, try again",100,100),e.abrupt("return");case 11:for(l=s/i.level.width,h=a/i.level.height,n.strokeStyle="white",u=0;u<i.level.height;u++)n.beginPath(),n.moveTo(0,u*h),n.lineTo(s,u*h),n.stroke();for(c=0;c<i.level.width;c++)n.beginPath(),n.moveTo(c*l,0),n.lineTo(c*l,a),n.stroke();n.fillStyle="grey",n.fillRect(i.level.start.x*l,i.level.start.y*h,l,h),n.fillStyle="lightgreen",n.fillRect(i.level.win.x*l,i.level.win.y*h,l,h),n.fillStyle="lightgrey",i.level.blocks.forEach(function(e){n.fillRect(e.x*l,e.y*h,l,h)}),n.drawImage(r.hero.image,i.hero.point.x*l+.2*l,i.hero.point.y*h+.2*h,.6*l,.6*h);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();function S(){var e=Object(l.a)(["\n  width: 800px;\n  height: 600px;\n"]);return S=function(){return e},e}var P=d.a.canvas(S()),N=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(c.a)(this,Object(v.a)(t).call(this,e))).canvasRef=void 0,n.manager=void 0,n.canvasRef=r.a.createRef(),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e&&(this.manager=new E(e),this.manager.newLevel())}},{key:"render",value:function(){return r.a.createElement(P,{ref:this.canvasRef})}}]),t}(r.a.Component);function W(){var e=Object(l.a)(["\n  padding: 2rem;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n"]);return W=function(){return e},e}var D=d.a.div(W());n(32);var I={testLevelGen:function(){var e=new b(5,5,new O(1,1),new O(3,3),[new O(2,4)]);console.log(e.print()),console.log(e.solve());var t=new b(5,5,new O(1,1),new O(3,3),[new O(4,0)]);console.log(t.print()),console.log(t.solve()),new M(5,5,.1,5).generateLevels(10,1e3).forEach(function(e){console.log(e.level.print()),console.log("Solution:",e.soln.printMoves()),console.log("\n")})}};window.scripts=I,a.a.render(r.a.createElement(function(){return r.a.createElement(D,null,r.a.createElement("h1",null,"ice slide puzzle game"),r.a.createElement("p",null,"use arrow keys to move, R to restart, and N to make new level"),r.a.createElement(N,null))},null),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.1a341b87.chunk.js.map